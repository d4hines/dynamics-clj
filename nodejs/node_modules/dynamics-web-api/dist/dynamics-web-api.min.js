/*! dynamics-web-api v1.4.2 (c) 2018 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t){var n={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){n.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){n.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){n.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){n.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=n},function(e,t){function n(e,t,n){throw new Error(n?e+" requires the "+t+" parameter to be of type "+n:e+" requires the "+t+" parameter.")}var r={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,r,a){void 0!==e&&null!==e&&""!=e||n(t,r,a)},stringParameterCheck:function(e,t,r){"string"!=typeof e&&n(t,r,"String")},arrayParameterCheck:function(e,t,r){e.constructor!==Array&&n(t,r,"Array")},stringOrArrayParameterCheck:function(e,t,r){e.constructor!==Array&&"string"!=typeof e&&n(t,r,"String or Array")},numberParameterCheck:function(e,t,r){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;n(t,r,"Number")}},boolParameterCheck:function(e,t,r){"boolean"!=typeof e&&n(t,r,"Boolean")},guidParameterCheck:function(e,t,r){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){n(t,r,"GUID String")}},keyParameterCheck:function(e,t,a){try{r.stringParameterCheck(e,t,a);var i=/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e);if(i)return i[0];var o=e.split(",");if(o.length)for(var s=0;s<o.length;s++)o[s]=o[s].trim(),/^[\w\d\_]+\='[^\'\r\n]+'$/i.exec(o[s])[0];return o.join(",")}catch(e){n(t,a,"String representing GUID or Alternate Key")}},callbackParameterCheck:function(e,t,r){"function"!=typeof e&&n(t,r,"Function")}};e.exports=r},function(e,t){String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return-1!==r&&r===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,n){function r(e){return void 0===e||"unknown"==typeof e||null==e}function a(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function i(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!r(Xrm.Utility)&&!r(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!r(Xrm.Page)&&!r(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function o(){var e=i();if(e){var t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}return""}function s(e){return o()+"/api/data/v"+e+"/"}function c(){return"undefined"!=typeof Xrm?Xrm.Internal:null}var u={buildFunctionParameters:n(11),getFetchXmlPagingCookie:n(14),convertToReferenceObject:n(13),isNull:r,generateUUID:a,getXrmContext:i,getXrmInternal:c,getClientUrl:o,initWebApiUrl:s};e.exports=u},function(e,t,n){function r(e){var t=f.getXrmInternal();if(!f.isNull(t)){var n=t.getEntitySetName(e);return n||e}var n=null;if(!f.isNull(p)&&(n=p[e],f.isNull(n)))for(var r in p)if(p[r]==e)return e;return n}function a(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]="application/json; charset=utf-8",e}function i(e,t){var n;return e&&(n=JSON.stringify(e,function(e,n){if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof n){if(/\(\{[\w\d-]+\}\)/g.test(n)&&(n=n.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){var a=/([\w_]+)(\([\d\w-]+\))$/,i=a.exec(n);if(i.length>2){var o=r(i[1]);f.isNull(o)||(n=n.replace(a,o+"$2"))}}n.startsWith(t.webApiUrl)||(n=t.webApiUrl+n.replace(/^\\/,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(n=void 0);return n}),n=n.replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})),n}function o(e,t,r,o,s,c,u,l){s||(s={}),s=a(s);var p=i(o,r);if(t.length>2e3){var m="dwa_batch_"+f.generateUUID(),h=[];h.push("--"+m),h.push("Content-Type: application/http"),h.push("Content-Transfer-Encoding: binary\n"),h.push(e+" "+r.webApiUrl+t+" HTTP/1.1");for(var d in s)h.push(d+": "+s[d]),delete s[d];h.push("\n--"+m+"--"),p=h.join("\n"),s=a(s),s["Content-Type"]="multipart/mixed;boundary="+m,t="$batch",e="POST"}r.impersonate&&!s.MSCRMCallerID&&(s.MSCRMCallerID=r.impersonate);var y;y=n(9);var g=function(n){n&&(s||(s={}),s.Authorization="Bearer "+n.accessToken),y(e,r.webApiUrl+t,p,s,c,u,l)};r.onTokenRefresh&&(!s||s&&!s.Authorization)?r.onTokenRefresh(g):g()}function s(e,t,n,a){var i=function(t){p={};for(var a=0;a<t.data.value.length;a++)p[t.data.value[a].LogicalName]=t.data.value[a].LogicalCollectionName;n(r(e))},s=function(e){a({message:"Unable to fetch EntityDefinitions. Error: "+e.message})},c=m.convertRequest({collection:"EntityDefinitions",select:["LogicalCollectionName","LogicalName"],noCache:!0},"retrieveMultiple",t);o("GET",c.url,t,null,c.headers,i,s,c.async)}function c(e){return["EntityDefinitions","$metadata","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions"].indexOf(e)>-1}function u(e,t,n,a){if(c(e)||f.isNull(e))return void n(e);if(e=e.toLowerCase(),!t.useEntityNames)return void n(e);try{var i=r(e);f.isNull(i)?s(e,t,n,a):n(i)}catch(e){a({message:"Unable to fetch Collection Names. Error: "+e.message})}}function l(e,t,n,r,a,i){var s=function(s){t.collection=s;var c=m.convertRequest(t,n,r);o(e,c.url,r,t.data||t.entity,c.headers,a,i,c.async)};u(t.collection,r,s,i)}var p,f=(n(0),n(3)),m=n(10);e.exports={sendRequest:o,makeRequest:l,getCollectionName:r}},function(e,t,n){function r(e){var t={webApiVersion:"8.0",webApiUrl:null,impersonate:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null};e||(e=t),this.setConfig=function(e){e.webApiVersion&&(o.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(o.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl=i.initWebApiUrl(t.webApiVersion),e.impersonate&&(t.impersonate=o.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.onTokenRefresh&&(o.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(o.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(o.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(o.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation),e.useEntityNames&&(o.boolParameterCheck(e.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),t.useEntityNames=e.useEntityNames)},this.setConfig(e);var n=function(e,n,r){return new Promise(function(a,i){s.makeRequest(e,n,r,t,a,i)})};this.createRequest=function(e){return o.parameterCheck(e,"DynamicsWebApi.create","request"),n("POST",e,"create").then(function(e){return e.data?e.data:/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"])[0]})},this.create=function(e,t,n,r){o.parameterCheck(e,"DynamicsWebApi.create","object"),o.stringParameterCheck(t,"DynamicsWebApi.create","collection"),n&&o.stringOrArrayParameterCheck(n,"DynamicsWebApi.create","prefer"),r&&o.arrayParameterCheck(r,"DynamicsWebApi.create","select");var a={collection:t,select:r,prefer:n,entity:e};return this.createRequest(a)},this.retrieveRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.retrieve","request");var t=e.select;return n("GET",e,"retrieve").then(function(e){return null!=t&&1==t.length&&t[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?i.convertToReferenceObject(e.data):e.data})},this.retrieve=function(e,t,n,r){o.stringParameterCheck(e,"DynamicsWebApi.retrieve","key"),e=o.keyParameterCheck(e,"DynamicsWebApi.retrieve","key"),o.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),n&&n.length&&o.arrayParameterCheck(n,"DynamicsWebApi.retrieve","select"),r&&r.length&&o.stringOrArrayParameterCheck(r,"DynamicsWebApi.retrieve","expand");var a={collection:t,key:e,select:n,expand:r};return this.retrieveRequest(a)},this.updateRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.update","request"),null==e.ifmatch&&(e.ifmatch="*");var t=e.collection.indexOf("EntityDefinitions")>-1?"PUT":"PATCH",r=e.ifmatch;return n(t,e,"update").then(function(e){return!e.data||e.data}).catch(function(e){if(r&&412==e.status)return!1;throw e})},this.update=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.update","key"),e=o.keyParameterCheck(e,"DynamicsWebApi.update","key"),o.parameterCheck(n,"DynamicsWebApi.update","object"),o.stringParameterCheck(t,"DynamicsWebApi.update","collection"),r&&o.stringOrArrayParameterCheck(r,"DynamicsWebApi.update","prefer"),a&&o.arrayParameterCheck(a,"DynamicsWebApi.update","select");var i={collection:t,key:e,select:a,prefer:r,entity:n};return this.updateRequest(i)},this.updateSingleProperty=function(e,t,r,a,i){o.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),e=o.keyParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),o.parameterCheck(r,"DynamicsWebApi.updateSingleProperty","keyValuePair"),o.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection");var s=Object.keys(r)[0],c=r[s];return a&&o.stringOrArrayParameterCheck(a,"DynamicsWebApi.updateSingleProperty","prefer"),i&&o.arrayParameterCheck(i,"DynamicsWebApi.updateSingleProperty","select"),n("PUT",{collection:t,key:e,select:i,prefer:a,navigationProperty:s,data:{value:c}},"updateSingleProperty").then(function(e){if(e.data)return e.data})},this.deleteRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.delete","request");var t=e.ifmatch;return n("DELETE",e,"delete").then(function(){return!0}).catch(function(e){if(t&&412==e.status)return!1;throw e})},this.deleteRecord=function(e,t,r){return o.stringParameterCheck(t,"DynamicsWebApi.deleteRecord","collection"),null!=r&&o.stringParameterCheck(r,"DynamicsWebApi.deleteRecord","propertyName"),n("DELETE",{navigationProperty:r,collection:t,key:e},"deleteRecord").then(function(){})},this.upsertRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.upsert","request");var t=e.ifnonematch,r=e.ifmatch;return n("PATCH",e,"upsert").then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"])[0]}if(e.data)return e.data}).catch(function(e){if(!(t&&412==e.status||r&&404==e.status))throw e})},this.upsert=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.upsert","key"),e=o.keyParameterCheck(e,"DynamicsWebApi.upsert","key"),o.parameterCheck(n,"DynamicsWebApi.upsert","object"),o.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),r&&o.stringOrArrayParameterCheck(r,"DynamicsWebApi.upsert","prefer"),a&&o.arrayParameterCheck(a,"DynamicsWebApi.upsert","select");var i={collection:t,key:e,select:a,prefer:r,entity:n};return this.upsertRequest(i)};var c=function(e,t){t&&(o.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),e.url=t);var r=e.count;return n("GET",e,"retrieveMultiple").then(function(e){return r&&(e.data.oDataCount=e.data.oDataCount||0),e.data})};this.retrieveMultipleRequest=c;var u=function(e,t,n){var n=n||[];return c(e,t).then(function(t){return n=n.concat(t.value),t.oDataNextLink?u(e,t.oDataNextLink,n):{value:n}})};this.retrieveAllRequest=function(e){return u(e)},this.count=function(e,t){if(null==t||null!=t&&!t.length){return n("GET",{collection:e,navigationProperty:"$count"},"count").then(function(e){return e.data?parseInt(e.data):0})}return this.retrieveMultipleRequest({collection:e,filter:t,count:!0},null).then(function(e){return e.oDataCount?e.oDataCount:0})},this.countAll=function(e,t,n){return u({collection:e,filter:t,select:n}).then(function(e){return e&&e.value?e.value.length:0})},this.retrieveMultiple=function(e,t,n,r){return this.retrieveMultipleRequest({collection:e,select:t,filter:n},r)},this.retrieveAll=function(e,t,n){return u({collection:e,select:t,filter:n})};var l=function(e,t,r,s,c,u){o.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),s=s||1,o.numberParameterCheck(s,"DynamicsWebApi.executeFetchXml","pageNumber");var l='$1 page="'+s+'"';return null!=c&&(o.stringParameterCheck(c,"DynamicsWebApi.executeFetchXml","pagingCookie"),l+=' paging-cookie="'+c+'"'),t=t.replace(/^(<fetch[\w\d\s'"=]+)/,l),n("GET",{collection:e,includeAnnotations:r,impersonate:u,fetchXml:t,impersonate:u,includeAnnotations:r},"executeFetchXml").then(function(e){return null!=e.data["@"+a.Prefer.Annotations.FetchXmlPagingCookie]&&(e.data.PagingInfo=i.getFetchXmlPagingCookie(e.data["@"+a.Prefer.Annotations.FetchXmlPagingCookie],s)),e.data})};this.fetch=l,this.executeFetchXml=l;var p=function(e,t,n,r,a,i,o){var o=o||[];return l(e,t,n,r,a,i).then(function(r){return o=o.concat(r.value),r.PagingInfo?p(e,t,n,r.PagingInfo.nextPage,r.PagingInfo.cookie,i,o):{value:o}})},f=function(e,t,n,r){return p(e,t,n,null,null,r)};this.fetchAll=f,this.executeFetchXmlAll=f,this.associate=function(e,t,r,a,i,s){return o.stringParameterCheck(a,"DynamicsWebApi.associate","relatedcollection"),o.stringParameterCheck(r,"DynamicsWebApi.associate","relationshipName"),t=o.keyParameterCheck(t,"DynamicsWebApi.associate","primaryKey"),i=o.keyParameterCheck(i,"DynamicsWebApi.associate","relatedKey"),n("POST",{_additionalUrl:r+"/$ref",collection:e,key:t,impersonate:s,data:{"@odata.id":a+"("+i+")"}},"associate").then(function(){})},this.disassociate=function(e,t,r,a,i){return o.stringParameterCheck(r,"DynamicsWebApi.disassociate","relationshipName"),a=o.keyParameterCheck(a,"DynamicsWebApi.disassociate","relatedId"),n("DELETE",{_additionalUrl:r+"("+a+")/$ref",collection:e,key:t,impersonate:i},"disassociate").then(function(){})},this.associateSingleValued=function(e,t,r,a,i,s){return i=o.keyParameterCheck(i,"DynamicsWebApi.associateSingleValued","relatedKey"),o.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),o.stringParameterCheck(a,"DynamicsWebApi.associateSingleValued","relatedcollection"),n("PUT",{_additionalUrl:r+"/$ref",collection:e,key:t,impersonate:s,data:{"@odata.id":a+"("+i+")"}},"associateSingleValued").then(function(){})},this.disassociateSingleValued=function(e,t,r,a){return o.stringParameterCheck(r,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),n("DELETE",{_additionalUrl:r+"/$ref",key:t,collection:e,impersonate:a},"disassociateSingleValued").then(function(){})},this.executeUnboundFunction=function(e,t,n){return m(e,t,null,null,n,!0)},this.executeBoundFunction=function(e,t,n,r,a){return m(n,r,t,e,a)};var m=function(e,t,r,a,s,c){o.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName");var u={_additionalUrl:e+i.buildFunctionParameters(t),_unboundRequest:c,key:a,collection:r,impersonate:s};return n("GET",u,"executeFunction").then(function(e){if(e.data)return e.data})};this.executeUnboundAction=function(e,t,n){return h(e,t,null,null,n,!0)},this.executeBoundAction=function(e,t,n,r,a){return h(n,r,t,e,a)};var h=function(e,t,r,a,i,s){return o.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),n("POST",{_additionalUrl:e,_unboundRequest:s,collection:r,key:a,impersonate:i,data:t},"executeAction").then(function(e){if(e.data)return e.data})};this.initializeInstance=function(e){return e||(e=t),new r(e)}}var a=n(0),i=n(3),o=n(1),s=n(4);String.prototype.endsWith&&String.prototype.startsWith||n(2),r.prototype.utility={getCollectionName:s.getCollectionName},e.exports=r},function(e,t){e.exports=function(e,t){var n;return"string"==typeof t&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])):t}},function(e,t,n){function r(e){var t=e.substr(0,e.indexOf("\r\n")),n=e.split(t);n.shift(),n.pop();for(var r=[],a=0;a<n.length;a++){var i=n[a],o=i.substring(i.indexOf("{"),i.lastIndexOf("}")+1);r.push(JSON.parse(o,s))}return r}function a(e,t){var n=null;if(-1!==e.indexOf("@")){var r=e.split("@");switch(r[1]){case"odata.context":n="oDataContext";break;case"odata.count":n="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":n="oDataNextLink";break;case o.Prefer.Annotations.FormattedValue:n=r[0]+"_Formatted";break;case o.Prefer.Annotations.AssociatedNavigationProperty:n=r[0]+"_NavigationProperty";break;case o.Prefer.Annotations.LookupLogicalName:n=r[0]+"_LogicalName"}}return[n,t]}function i(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];if(null!=e[r]&&e[r].constructor===Array)for(var o=0;o<e[r].length;o++)e[r][o]=i(e[r][o]);var s=a(r,e[r]);if(s[0]&&(e[s[0]]=s[1]),-1!==r.indexOf("_x002e_")){var c=r.split("_x002e_");if(e.hasOwnProperty(c[0])){if("object"!=typeof e[c[0]]||"object"==typeof e[c[0]]&&!e[c[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[c[0]]={_dwaType:"alias"};e[c[0]][c[1]]=e[r],s=a(c[1],e[r]),s[0]&&(e[c[0]][s[0]]=s[1])}}return e}var o=n(0),s=n(6);String.prototype.endsWith&&String.prototype.startsWith||n(2),e.exports=function(e){var t=null;return e.length&&(t=t=e.indexOf("--batchresponse_")>-1?r(e)[0]:JSON.parse(e,s),t=i(t)),t}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0,a=n.length;r<a;r++){var i=n[r],o=i.indexOf(": ");o>0&&(t[i.substring(0,o)]=i.substring(o+2))}return t}},function(e,t,n){var r=n(7),a=n(8),i=function(e,t,n,i,o,s,c){var u=new XMLHttpRequest;u.open(e,t,c);for(var l in i)u.setRequestHeader(l,i[l]);u.onreadystatechange=function(){if(4===u.readyState){switch(u.status){case 200:case 201:case 204:case 304:var e=r(u.responseText),t={data:e,headers:a(u.getAllResponseHeaders()),status:u.status};o(t);break;default:var n;try{n=JSON.parse(u.response).error}catch(e){n=u.response.length>0?{message:u.response}:{message:"Unexpected Error"}}n.status=u.status,n.statusText=u.statusText,s(n)}u=null}},u.onerror=function(){s({message:"Network Error"}),u=null},u.ontimeout=function(e){s({message:"Request Timed Out"}),u=null},n?u.send(n):u.send()};e.exports=i},function(e,t,n){function r(e,t,n,a,s){var c={},u=[];if(a=null!=a?a:"&",e){if(e.navigationProperty&&(i.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),n+="/"+e.navigationProperty),null!=e.select&&e.select.length&&(i.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?n+=e.select.shift():e.select.shift()),e.select.length&&u.push("$select="+e.select.join(",")))),e.filter){i.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter");var l=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,p=e.filter.replace(l," $1 ").trim();u.push("$filter="+encodeURIComponent(p))}e.savedQuery&&u.push("savedQuery="+i.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&u.push("userQuery="+i.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.count&&(i.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),u.push("$count="+e.count)),e.top&&e.top>0&&(i.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),u.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(i.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),u.push("$orderby="+e.orderBy.join(",")));var f=o(e,t,s);if(f.length&&(c.Prefer=f),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(i.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),c["If-Match"]=e.ifmatch),e.ifnonematch&&(i.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),c["If-None-Match"]=e.ifnonematch),e.impersonate&&(i.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),c.MSCRMCallerID=i.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.token&&(i.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),c.Authorization="Bearer "+e.token),e.duplicateDetection&&(i.boolParameterCheck(e.duplicateDetection,"DynamicsWebApi."+t,"request.duplicateDetection"),c["MSCRM.SuppressDuplicateDetection"]="false"),e.entity&&i.parameterCheck(e.entity,"DynamicsWebApi."+t,"request.entity"),e.data&&i.parameterCheck(e.data,"DynamicsWebApi."+t,"request.data"),e.noCache&&(i.boolParameterCheck(e.noCache,"DynamicsWebApi."+t,"request.noCache"),c["Cache-Control"]="no-cache"),e.mergeLabels&&(i.boolParameterCheck(e.mergeLabels,"DynamicsWebApi."+t,"request.mergeLabels"),c["MSCRM.MergeLabels"]="true"),e.expand&&e.expand.length)if(i.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)u.push("$expand="+e.expand);else{for(var m=[],h=0;h<e.expand.length;h++)if(e.expand[h].property){var d=r(e.expand[h],t+" $expand",null,";"),y=d.query;y&&y.length&&(y="("+y+")"),m.push(e.expand[h].property+y)}m.length&&u.push("$expand="+m.join(","))}}return{url:n,query:u.join(a),headers:c}}function a(e,t,n){var a,o="";return e.url?(i.stringParameterCheck(e.url,"DynamicsWebApi."+t,"request.url"),o=e.url.replace(n.webApiUrl,""),a=r(e,t,o,"&",n)):(e._unboundRequest||e.collection||i.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),e.collection&&(i.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),o=e.collection,e.key?e.key=i.keyParameterCheck(e.key,"DynamicsWebApi."+t,"request.key"):e.id&&(e.key=i.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id")),e.key&&(o+="("+e.key+")")),e._additionalUrl&&(o&&(o+="/"),o+=e._additionalUrl),a=r(e,t,o,"&",n),e.fetchXml?(i.stringParameterCheck(e.fetchXml,"DynamicsWebApi."+t,"request.fetchXml"),a.url+="?fetchXml="+encodeURIComponent(e.fetchXml)):a.query&&(a.url+="?"+a.query)),e.hasOwnProperty("async")&&null!=e.async?(i.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),a.async=e.async):a.async=!0,{url:a.url,headers:a.headers,async:a.async}}var i=(n(0),n(1)),o=n(12),s={convertRequestOptions:r,convertRequest:a};e.exports=s},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),n="",r="",a=1;a<=t.length;a++){var i=t[a-1],o=e[i];a>1&&(n+=",",r+="&"),n+=i+"=@p"+a,r+="@p"+a+"="+("string"==typeof o?"'"+o+"'":o)}return"("+n+")?"+r}return"()"}},function(e,t,n){var r=n(0),a=n(1);e.exports=function(e,t,n){var i=e.returnRepresentation,o=e.includeAnnotations,s=e.maxPageSize;if(e.prefer&&e.prefer.length){a.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer");var c=e.prefer;"string"==typeof c&&(c=c.split(","));for(var u in c){var l=c[u].trim();l===r.Prefer.ReturnRepresentation?i=!0:l.startsWith("odata.include-annotations=")?o=l.replace("odata.include-annotations=","").replace(/"/g,""):l.startsWith("odata.maxpagesize=")&&(s=l.replace("odata.maxpagesize=","").replace(/"/g,""))}}n&&(null==i&&(i=n.returnRepresentation),o=o||n.includeAnnotations,s=s||n.maxPageSize);var c=[];return i&&(a.boolParameterCheck(i,"DynamicsWebApi."+t,"request.returnRepresentation"),c.push(r.Prefer.ReturnRepresentation)),o&&(a.stringParameterCheck(o,"DynamicsWebApi."+t,"request.includeAnnotations"),c.push('odata.include-annotations="'+o+'"')),s&&s>0&&(a.numberParameterCheck(s,"DynamicsWebApi."+t,"request.maxPageSize"),c.push("odata.maxpagesize="+s)),c.join(",")}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var n=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=n){var r=parseInt(n[2]);return{cookie:n[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:r,nextPage:r+1}}return{cookie:"",page:t,nextPage:t+1}}}])});